# MvDC_HCRL
The code of paper"A Hierarchical Contrastive Representation Learning Model for Multi-view Document Clustering".

# Env
requirements.txt

```
========实例配置========
核数：9
内存：31 GB
磁盘：3% 901M/30G
显卡：Tesla P40, 1
Last login: Fri Mar  8 01:50:33 2024 from 172.17.0.1
cd "MvDC_HCRL-main"
(base) root@I189a74b1fd00301b0e:~# cd "MvDC_HCRL-main"
(base) root@I189a74b1fd00301b0e:~/MvDC_HCRL-main# nvidia-smi
Fri Mar  8 01:51:37 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Tesla P40                      On  | 00000000:04:00.0 Off |                  N/A |
| N/A   45C    P0              68W / 250W |   7636MiB / 23040MiB |    100%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

```

# Run
`python main_contrastive.py`

```
***** Loading training view *****
  Num examples = %d 790
Iteration-training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:21<00:00,  3.03s/it]
Iteration-training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:16<00:00,  2.35s/it]
Iteration-training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:18<00:00,  2.62s/it]
Iteration-training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:16<00:00,  2.40s/it]
Iteration-training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:18<00:00,  2.58s/it]
Iteration-training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:17<00:00,  2.55s/it]
Epoch: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [01:49<00:00, 18.20s/it]
Extracting representation I: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.66s/it]
view fusion
{'ACC': 0.9215, 'NMI': 0.7845, 'ARI': 0.8008}
view index = 0
{'ACC': 0.8582, 'NMI': 0.6537, 'ARI': 0.6619}
view index = 1
{'ACC': 0.9367, 'NMI': 0.8116, 'ARI': 0.841}
view common
{'ACC': 0.9215, 'NMI': 0.7848, 'ARI': 0.8004}
Extracting pro of q: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:14<00:00,  2.08s/it]
[[167   0   3  23]
 [  0 167  19  14]
 [  4   1 191   3]
 [  0   0   0 198]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.22s/it]
0 {'ACC': 0.9152, 'NMI': 0.777, 'ARI': 0.7856, 'fine-tining_loss': 2.5168, 'delta_label': 0.0013, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.21s/it]
1 {'ACC': 0.9595, 'NMI': 0.8693, 'ARI': 0.8947, 'fine-tining_loss': 2.4527, 'delta_label': 0.0911, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.24s/it]
2 {'ACC': 0.9722, 'NMI': 0.9043, 'ARI': 0.9274, 'fine-tining_loss': 2.303, 'delta_label': 0.0304, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.25s/it]
3 {'ACC': 0.9722, 'NMI': 0.899, 'ARI': 0.927, 'fine-tining_loss': 2.2921, 'delta_label': 0.0304, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.25s/it]
4 {'ACC': 0.9709, 'NMI': 0.8905, 'ARI': 0.9239, 'fine-tining_loss': 2.2288, 'delta_label': 0.0215, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.25s/it]
5 {'ACC': 0.9734, 'NMI': 0.9005, 'ARI': 0.9305, 'fine-tining_loss': 2.1984, 'delta_label': 0.0101, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:11<00:00,  1.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:22<00:00,  3.21s/it]
6 {'ACC': 0.9785, 'NMI': 0.9163, 'ARI': 0.9437, 'fine-tining_loss': 2.1837, 'delta_label': 0.0076, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:06<00:00,  1.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:09<00:00,  1.32s/it]
7 {'ACC': 0.9747, 'NMI': 0.9055, 'ARI': 0.9338, 'fine-tining_loss': 2.1609, 'delta_label': 0.0114, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:06<00:00,  1.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:09<00:00,  1.33s/it]
8 {'ACC': 0.9785, 'NMI': 0.9163, 'ARI': 0.9437, 'fine-tining_loss': 2.154, 'delta_label': 0.0114, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:06<00:00,  1.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:09<00:00,  1.33s/it]
9 {'ACC': 0.9759, 'NMI': 0.9078, 'ARI': 0.9371, 'fine-tining_loss': 2.1536, 'delta_label': 0.0051, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}
Extracting pro of q: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:06<00:00,  1.04it/s]
final confusion_matrix 
 [[186   2   3   2]
 [  0 197   3   0]
 [  4   3 192   0]
 [  1   0   0 197]]
{'dataset': 'chinese_news', 'bert_model': 'bert-base-chinese', 'num_train_epochs': 6, 'max_seq_length': 100, 'train_batch_size': 128, 'thresholds': [1, 0.925], 'global_length': 5, 'CL-CluR-Data': {'ACC': 0.9152, 'NMI': 0.777, 'ARI': 0.7856}, 'lambda': 1, 'lr': 5e-05, 'CL-CluR-Final': {'ACC': 0.9759, 'NMI': 0.9078, 'ARI': 0.9371, 'fine-tining_loss': 2.1536, 'delta_label': 0.0051, 'view_weights': [array(0.5, dtype=float32), array(0.5, dtype=float32)]}}

```


# Reference
coming soon..
